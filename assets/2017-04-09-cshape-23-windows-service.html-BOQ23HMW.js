import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,a,o as e}from"./app-uJE4P3e0.js";const l={};function t(p,s){return e(),n("div",null,s[0]||(s[0]=[a(`<h1 id="windows-service" tabindex="-1"><a class="header-anchor" href="#windows-service"><span>Windows Service</span></a></h1><p>一个<a href="https://msdn.microsoft.com/zh-cn/library/y817hyb6(v=vs.110).aspx" target="_blank" rel="noopener noreferrer">Windows服务程序</a>是在Windows操作系统下能完成特定功能的可执行的应用程序。</p><p>Windows服务程序虽然是可执行的，但是它不像一般的可执行文件通过双击就能开始运行了，它必须有特定的启动方式。</p><p>这些启动方式包括了<strong>自动启动</strong>和<strong>手动启动</strong>两种。</p><h1 id="hello-world" tabindex="-1"><a class="header-anchor" href="#hello-world"><span>Hello World</span></a></h1><h2 id="创建windows-service项目" tabindex="-1"><a class="header-anchor" href="#创建windows-service项目"><span>创建Windows Service项目</span></a></h2><ul><li>Create</li></ul><p>【Visual C#】-&gt;【Windows】-&gt;【Windows 服务】</p><ul><li>Edit</li></ul><p>双击<code>Service1.cs</code>，根据页面提示。单击可查看代码，或者右键查看源码。</p><ul><li>Service1.cs</li></ul><p>初始化的代码修改如下</p><div class="language-c# line-numbers-mode" data-highlighter="shiki" data-ext="c#" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">using</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">using</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Collections</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Generic</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">using</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">ComponentModel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">using</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">using</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Diagnostics</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">using</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Linq</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">using</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">ServiceProcess</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">using</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Text</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">using</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Threading</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Tasks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">namespace</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> WindowsServiceTest</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> partial</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Service1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> : </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">ServiceBase</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        public</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Service1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">            InitializeComponent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        protected</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> override</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> OnStart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">string</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[] </span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">args</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            using</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">IO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">StreamWriter</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> sw</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> new </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">IO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">StreamWriter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;D:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">log.txt&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">                sw</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WriteLine</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">DateTime</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">Now</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ToString</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;yyyy-MM-dd HH:mm:ss &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot; Start.&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        protected</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> override</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> OnStop</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            using</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">IO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">StreamWriter</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> sw</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> new </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">IO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">StreamWriter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;D:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">log.txt&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">                sw</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WriteLine</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">DateTime</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">Now</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ToString</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;yyyy-MM-dd HH:mm:ss &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot; Stop.&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="创建服务安装程序" tabindex="-1"><a class="header-anchor" href="#创建服务安装程序"><span>创建服务安装程序</span></a></h2><ul><li>添加安装程序</li></ul><p>双击<code>Service1.cs</code>，右键-&gt;【添加安装程序】。自动生成如下</p><figure><img src="https://raw.githubusercontent.com/houbb/resource/master/img/network/windows-service/2017-04-21-windows-service-installer.png" alt="windows-service-installer" tabindex="0" loading="lazy"><figcaption>windows-service-installer</figcaption></figure><ul><li>修改安装服务名</li></ul><p>右键<code>serviceInsraller1</code>，选择属性，将ServiceName的值改为<strong>你想要的服务名</strong>，比如<em>ServiceTest</em>。</p><ul><li>修改安装权限</li></ul><p>右键<code>serviceProcessInsraller1</code>，选择属性，将Account的值改为<strong>LocalSystem</strong>。</p><h2 id="编写安装脚本" tabindex="-1"><a class="header-anchor" href="#编写安装脚本"><span>编写安装脚本</span></a></h2><p>在项目中添加2个文件如下(必须是<strong>ANSI</strong>或者<strong>UTF-8无BOM格式</strong>)：</p><p>(其实脚本放在哪里都行，使用绝对路径即可)</p><p>编译一下项目。确定<code>WindowsServiceTest.exe</code>的绝对路径。(理论上相对路径是可以的，我试了一下找的却不是当前路径下的。可自行尝试)</p><ul><li>Install.bat</li></ul><div class="language-bat line-numbers-mode" data-highlighter="shiki" data-ext="bat" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%SystemRoot%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\Microsoft.NET\\Framework\\v4.0.30319\\installutil.exe E:\\LEARN\\Socket\\NetSocket\\WindowsServiceTest\\bin\\Release\\WindowsServiceTest.exe</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">Net Start</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ServiceTest</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">sc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> config ServiceTest start= auto</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">pause</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中:</p><p>%SystemRoot%\\Microsoft.NET\\Framework\\v4.0.30319\\installutil.exe 为.Net工具地址。</p><p>E:\\LEARN\\Socket\\NetSocket\\WindowsServiceTest\\bin\\Release\\WindowsServiceTest.exe 是项目<strong>编译后</strong>的运行程序地址</p><p>Net Start ServiceTest 为启动服务。</p><p>sc config ServiceTest start= auto 为设置服务为自动运行。</p><p>最后一行用于调试，暂停的。</p><ul><li>Uninstall.bat</li></ul><div class="language-bat line-numbers-mode" data-highlighter="shiki" data-ext="bat" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%SystemRoot%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\Microsoft.NET\\Framework\\v4.0.30319\\installutil.exe /u E:\\LEARN\\Socket\\NetSocket\\WindowsServiceTest\\bin\\Release\\WindowsServiceTest.exe</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">pause</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="运行尝试" tabindex="-1"><a class="header-anchor" href="#运行尝试"><span>运行尝试</span></a></h2><p>直接以<strong>管理员身份</strong>运行 <code>Install.bat</code>, Console 日志如下</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>正在运行事务处理安装。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>正在开始安装的“安装”阶段。</span></span>
<span class="line"><span>查看日志文件的内容以获得 E:\\LEARN\\Socket\\NetSocket\\WindowsServiceTest\\bin\\Releas</span></span>
<span class="line"><span>e\\WindowsServiceTest.exe 程序集的进度。</span></span>
<span class="line"><span>该文件位于 E:\\LEARN\\Socket\\NetSocket\\WindowsServiceTest\\bin\\Release\\WindowsServi</span></span>
<span class="line"><span>ceTest.InstallLog。</span></span>
<span class="line"><span>正在安装程序集“E:\\LEARN\\Socket\\NetSocket\\WindowsServiceTest\\bin\\Release\\Windows</span></span>
<span class="line"><span>ServiceTest.exe”。</span></span>
<span class="line"><span>受影响的参数是:</span></span>
<span class="line"><span>   logtoconsole =</span></span>
<span class="line"><span>   logfile = E:\\LEARN\\Socket\\NetSocket\\WindowsServiceTest\\bin\\Release\\WindowsSer</span></span>
<span class="line"><span>viceTest.InstallLog</span></span>
<span class="line"><span>   assemblypath = E:\\LEARN\\Socket\\NetSocket\\WindowsServiceTest\\bin\\Release\\Windo</span></span>
<span class="line"><span>wsServiceTest.exe</span></span>
<span class="line"><span>正在安装服务 ServiceTest...</span></span>
<span class="line"><span>已成功安装服务 ServiceTest。</span></span>
<span class="line"><span>正在日志 Application 中创建 EventLog 源 ServiceTest...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>“安装”阶段已成功完成，正在开始“提交”阶段。</span></span>
<span class="line"><span>查看日志文件的内容以获得 E:\\LEARN\\Socket\\NetSocket\\WindowsServiceTest\\bin\\Releas</span></span>
<span class="line"><span>e\\WindowsServiceTest.exe 程序集的进度。</span></span>
<span class="line"><span>该文件位于 E:\\LEARN\\Socket\\NetSocket\\WindowsServiceTest\\bin\\Release\\WindowsServi</span></span>
<span class="line"><span>ceTest.InstallLog。</span></span>
<span class="line"><span>正在提交程序集“E:\\LEARN\\Socket\\NetSocket\\WindowsServiceTest\\bin\\Release\\Windows</span></span>
<span class="line"><span>ServiceTest.exe”。</span></span>
<span class="line"><span>受影响的参数是:</span></span>
<span class="line"><span>   logtoconsole =</span></span>
<span class="line"><span>   logfile = E:\\LEARN\\Socket\\NetSocket\\WindowsServiceTest\\bin\\Release\\WindowsSer</span></span>
<span class="line"><span>viceTest.InstallLog</span></span>
<span class="line"><span>   assemblypath = E:\\LEARN\\Socket\\NetSocket\\WindowsServiceTest\\bin\\Release\\Windo</span></span>
<span class="line"><span>wsServiceTest.exe</span></span>
<span class="line"><span></span></span>
<span class="line"><span>“提交”阶段已成功完成。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>已完成事务处理安装。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>C:\\Windows\\system32&gt;Net Start ServiceTest</span></span>
<span class="line"><span>ServiceTest 服务正在启动 .</span></span>
<span class="line"><span>ServiceTest 服务已经启动成功。</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>C:\\Windows\\system32&gt;sc config ServiceTest start= auto</span></span>
<span class="line"><span>[SC] ChangeServiceConfig 成功</span></span>
<span class="line"><span></span></span>
<span class="line"><span>C:\\Windows\\system32&gt;pause</span></span>
<span class="line"><span>请按任意键继续. . .</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以在【计算机】-&gt;【管理】-&gt;【服务】里看到对应的服务。此处为 <strong>ServiceTest</strong>.</p><p>此时D盘对应日志文件内容为</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>2017-04-21 16:53:08  Start.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="卸载" tabindex="-1"><a class="header-anchor" href="#卸载"><span>卸载</span></a></h2><p>以<strong>管理员身份</strong>运行 <code>Uninstall.bat</code> 脚本。Console 日志如下</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>正在开始卸载。</span></span>
<span class="line"><span>查看日志文件的内容以获得 E:\\LEARN\\Socket\\NetSocket\\WindowsServiceTest\\bin\\Releas</span></span>
<span class="line"><span>e\\WindowsServiceTest.exe 程序集的进度。</span></span>
<span class="line"><span>该文件位于 E:\\LEARN\\Socket\\NetSocket\\WindowsServiceTest\\bin\\Release\\WindowsServi</span></span>
<span class="line"><span>ceTest.InstallLog。</span></span>
<span class="line"><span>正在卸载程序集“E:\\LEARN\\Socket\\NetSocket\\WindowsServiceTest\\bin\\Release\\Windows</span></span>
<span class="line"><span>ServiceTest.exe”。</span></span>
<span class="line"><span>受影响的参数是:</span></span>
<span class="line"><span>   logtoconsole =</span></span>
<span class="line"><span>   logfile = E:\\LEARN\\Socket\\NetSocket\\WindowsServiceTest\\bin\\Release\\WindowsSer</span></span>
<span class="line"><span>viceTest.InstallLog</span></span>
<span class="line"><span>   assemblypath = E:\\LEARN\\Socket\\NetSocket\\WindowsServiceTest\\bin\\Release\\Windo</span></span>
<span class="line"><span>wsServiceTest.exe</span></span>
<span class="line"><span>正在移除 EventLog 源 ServiceTest。</span></span>
<span class="line"><span>正在从系统中移除服务 ServiceTest...</span></span>
<span class="line"><span>已成功地从系统中移除服务 ServiceTest。</span></span>
<span class="line"><span>尝试停止服务 ServiceTest。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>卸载完成。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>C:\\Windows\\system32&gt;pause</span></span>
<span class="line"><span>请按任意键继续. . .</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>此时，D盘对应日止文件内容变为</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>2017-04-21 16:53:08  Start.</span></span>
<span class="line"><span>2017-04-21 17:06:59  Stop.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>以上。</p><h1 id="引用" tabindex="-1"><a class="header-anchor" href="#引用"><span>引用</span></a></h1><p><a href="http://jingyan.baidu.com/article/cd4c2979e9330d756f6e6070.html" target="_blank" rel="noopener noreferrer">C# VS2013 中新建WindowsService定时任务</a></p><p><a href="http://www.cnblogs.com/bluestorm/p/3510398.html" target="_blank" rel="noopener noreferrer">C# 编写Windows Service（windows服务程序）</a></p><p><a href="http://www.cnblogs.com/sorex/archive/2012/05/16/2502001.html" target="_blank" rel="noopener noreferrer">C#创建Windows Service(Windows 服务)基础教程</a></p>`,51)]))}const d=i(l,[["render",t]]),k=JSON.parse('{"path":"/posts/Lang/2017-04-09-cshape-23-windows-service.html","title":"c#-023-Windows Service Windows 服务程序","lang":"zh-CN","frontmatter":{"title":"c#-023-Windows Service Windows 服务程序","date":"2017-04-09T00:00:00.000Z","categories":["C#"],"tags":["cshape","cshape","lang",".net","dotnet"],"published":true,"description":"Windows Service 一个Windows服务程序是在Windows操作系统下能完成特定功能的可执行的应用程序。 Windows服务程序虽然是可执行的，但是它不像一般的可执行文件通过双击就能开始运行了，它必须有特定的启动方式。 这些启动方式包括了自动启动和手动启动两种。 Hello World 创建Windows Service项目 Creat...","head":[["meta",{"property":"og:url","content":"https://houbb.github.io/blog-backend/posts/Lang/2017-04-09-cshape-23-windows-service.html"}],["meta",{"property":"og:site_name","content":"老马啸西风"}],["meta",{"property":"og:title","content":"c#-023-Windows Service Windows 服务程序"}],["meta",{"property":"og:description","content":"Windows Service 一个Windows服务程序是在Windows操作系统下能完成特定功能的可执行的应用程序。 Windows服务程序虽然是可执行的，但是它不像一般的可执行文件通过双击就能开始运行了，它必须有特定的启动方式。 这些启动方式包括了自动启动和手动启动两种。 Hello World 创建Windows Service项目 Creat..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://raw.githubusercontent.com/houbb/resource/master/img/network/windows-service/2017-04-21-windows-service-installer.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-08-22T03:45:14.000Z"}],["meta",{"property":"article:tag","content":"cshape"}],["meta",{"property":"article:tag","content":"cshape"}],["meta",{"property":"article:tag","content":"lang"}],["meta",{"property":"article:tag","content":".net"}],["meta",{"property":"article:tag","content":"dotnet"}],["meta",{"property":"article:published_time","content":"2017-04-09T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-08-22T03:45:14.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"c#-023-Windows Service Windows 服务程序\\",\\"image\\":[\\"https://raw.githubusercontent.com/houbb/resource/master/img/network/windows-service/2017-04-21-windows-service-installer.png\\"],\\"datePublished\\":\\"2017-04-09T00:00:00.000Z\\",\\"dateModified\\":\\"2025-08-22T03:45:14.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"老马啸西风\\",\\"url\\":\\"https://houbb.github.io\\"}]}"]]},"git":{"createdTime":1755834314000,"updatedTime":1755834314000,"contributors":[{"name":"binbin.hou","username":"","email":"binbin.hou@huifu.com","commits":1}]},"readingTime":{"minutes":3.83,"words":1148},"filePathRelative":"posts/Lang/2017-04-09-cshape-23-windows-service.md","localizedDate":"2017年4月9日","excerpt":"\\n<p>一个<a href=\\"https://msdn.microsoft.com/zh-cn/library/y817hyb6(v=vs.110).aspx\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Windows服务程序</a>是在Windows操作系统下能完成特定功能的可执行的应用程序。</p>\\n<p>Windows服务程序虽然是可执行的，但是它不像一般的可执行文件通过双击就能开始运行了，它必须有特定的启动方式。</p>\\n<p>这些启动方式包括了<strong>自动启动</strong>和<strong>手动启动</strong>两种。</p>","autoDesc":true}');export{d as comp,k as data};
